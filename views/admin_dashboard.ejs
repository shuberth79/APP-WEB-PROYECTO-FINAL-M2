<%- include('partials/head') %>
<%- include('partials/header') %>

<body>
    <div class="container mt-4">
        <h2>Panel de Administrador</h2>
        
        <div class="d-flex justify-content-between align-items-center mb-4">

        <a href="/logout" class="btn btn-danger">Cerrar Sesión</a>
        
    </div>
        
        <ul class="nav nav-tabs" id="adminTabs" role="tablist">

            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="usuarios-tab" data-bs-toggle="tab" data-bs-target="#usuarios" type="button" role="tab" aria-controls="usuarios" aria-selected="false">Usuarios</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="artistas-tab" data-bs-toggle="tab" data-bs-target="#artistas" type="button" role="tab" aria-controls="artistas" aria-selected="false">Artistas</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="escenarios-tab" data-bs-toggle="tab" data-bs-target="#escenarios" type="button" role="tab" aria-controls="escenarios" aria-selected="false">Escenarios</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="conciertos-tab" data-bs-toggle="tab" data-bs-target="#conciertos" type="button" role="tab" aria-controls="conciertos" aria-selected="true">Conciertos</button>
            </li>
        </ul>

        <div class="tab-content" id="adminTabsContent">
            <div class="tab-pane fade" id="conciertos" role="tabpanel" aria-labelledby="conciertos-tab">
                <h3 class="mt-3">Gestión de Conciertos</h3>
                <a href="/create_conciertoX" class="btn btn-primary mb-3">Crear Nuevo Concierto</a>
                <table class="table table-bordered table-striped mt-3">
                    <thead>
                        <tr>
                            <th>Ref</th>
                            <th>Nombre Concierto</th>
                            <th>Locaciones</th>
                            <th>Fecha</th>
                            <th>Hora</th>
                            <th>Ciudad</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% if (conciertos && conciertos.length > 0) { %>
                            <% conciertos.forEach(function(concierto){ %>
                                <tr>
                                    <td><%= concierto.concierto_id %></td>
                                    <td><%= concierto.nombre_concierto %></td>
                                    <td><%= concierto.locaciones %></td>
                                    <!-- <td><%= concierto.fecha %></td> -->
                                    <td>
                                        <%
                                        // Asegúrate de que `concierto.fecha` es un objeto Date
                                        const fecha = new Date(concierto.fecha);
                                        const fechaFormateada = fecha.toLocaleDateString('es-ES', {
                                            year: 'numeric',
                                            month: '2-digit',
                                            day: '2-digit'
                                        });
                                        %>
                                        <%= fechaFormateada %>
                                    </td>
                                    <td><%= concierto.hora %></td>
                                    <td><%= concierto.ciudad %></td>
                                    <td>
                                        <a href="/edit_concierto/<%= concierto.concierto_id %>" class="btn btn-info btn-sm">Editar</a>
                                        <form action="/delete_concierto" method="POST" style="display:inline;" onsubmit="return confirm('¿Estás seguro de eliminar este concierto?');">
                                            <input type="hidden" name="concierto_id" value="<%= concierto.concierto_id %>">
                                            <button type="submit" class="btn btn-danger btn-sm">Eliminar</button>
                                        </form>
                                    </td>
                                </tr>
                            <% }); %>
                        <% } else { %>
                            <tr>
                                <td colspan="5">No hay conciertos disponibles.</td>
                            </tr>
                        <% } %>
                    </tbody>
                </table>
            </div>

            <div class="tab-pane fade show active" id="usuarios" role="tabpanel" aria-labelledby="usuarios-tab">
                <h3 class="mt-3">Gestión de Usuarios</h3>
                <a href="/create_usuario" class="btn btn-primary mb-3">Crear Nuevo Usuario</a>
                <table class="table table-bordered table-striped mt-3">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Nombre</th>
                            <th>Rol</th>
                            <th>Email</th>
                            <th>Teléfono</th>
                            <th>Dirección</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% if (usuarios && usuarios.length > 0) { %>
                            <% usuarios.forEach(function(usuario){ %>
                                <tr>
                                    <td><%= usuario.usuario_id %></td>
                                    <td><%= usuario.nombre %></td>
                                    <td><%= usuario.rol %></td>
                                    <td><%= usuario.email %></td>
                                    <td><%= usuario.telefono %></td>
                                    <td><%= usuario.direccion %></td>
                                    <td>
                                        <a href="/edit_usuario/<%= usuario.usuario_id %>" class="btn btn-info btn-sm">Editar</a>
                                        <form action="/delete_usuario" method="POST" style="display:inline;" onsubmit="return confirm('¿Estás seguro de eliminar este usuario?');">
                                            <input type="hidden" name="usuario_id" value="<%= usuario.usuario_id %>">
                                            <button type="submit" class="btn btn-danger btn-sm">Eliminar</button>
                                        </form>
                                    </td>
                                </tr>
                            <% }); %>
                        <% } else { %>
                            <tr>
                                <td colspan="7">No hay usuarios disponibles.</td>
                            </tr>
                        <% } %>
                    </tbody>
                </table>
            </div>

            <div class="tab-pane fade" id="escenarios" role="tabpanel" aria-labelledby="escenarios-tab">
                <h3 class="mt-3">Gestión de Escenarios</h3>
                <a href="/create_escenario" class="btn btn-primary mb-3">Crear Nuevo Escenario</a>
                <table class="table table-bordered table-striped mt-3">
                    <thead>
                        <tr>
                            <th>ID Escenario</th>
                            <th>Nombre</th>
                            <th>Ubicación</th>
                            <th>Capacidad</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% if (escenarios && escenarios.length > 0) { %>
                            <% escenarios.forEach(function(escenario){ %>
                                <tr>
                                    <td><%= escenario.escenario_id %></td>
                                    <td><%= escenario.nombre %></td>
                                    <td><%= escenario.ubicacion %></td>
                                    <td><%= escenario.capacidad %></td>
                                    <td>
                                        <a href="/edit_escenario/<%= escenario.escenario_id %>" class="btn btn-info btn-sm">Editar</a>
                                        <form action="/delete_escenario" method="POST" style="display:inline;" onsubmit="return confirm('¿Estás seguro de eliminar este escenario?');">
                                            <input type="hidden" name="pedido_id" value="<%= escenario.escenario_id %>">
                                            <button type="submit" class="btn btn-danger btn-sm">Eliminar</button>
                                        </form>
                                    </td>
                                </tr>
                            <% }); %>
                        <% } else { %>
                            <tr>
                                <td colspan="7">No hay pedidos disponibles.</td>
                            </tr>
                        <% } %>
                    </tbody>
                </table>
            </div>

            <div class="tab-pane fade" id="artistas" role="tabpanel" aria-labelledby="artistas-tab">
                <h3 class="mt-3">Gestión de Artistas</h3>
                <a href="/create_artista" class="btn btn-primary mb-3">Ingresar Nuevo Artista</a>
                <table class="table table-bordered table-striped mt-3">
                    <thead>
                        <tr>
                            <th>ID artista</th>
                            <th>Nombre Completo</th>
                            <th>Genero Artístico</th>
                            <th>telefono</th>
                            <th>Ciudad</th>
                            <th>descripcion</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% if (artistas && artistas.length > 0) { %>
                            <% artistas.forEach(function(artista){ %>
                                <tr>
                                    <td><%= artista.artista_id %></td>
                                    <td><%= artista.nombre %></td>
                                    <td><%= artista.genero_artistico %></td>
                                    <td><%= artista.telefono %></td>
                                    <td><%= artista.ciudad %></td>
                                    <td><%= artista.descripcion %></td>
                                    <td>
                                        <a href="/edit_artista/<%= artista.artista_id %>" class="btn btn-info btn-sm">Editar</a>
                                        <form action="/delete_artista" method="POST" style="display:inline;" onsubmit="return confirm('¿Estás seguro de eliminar este Artista?');">
                                            <input type="hidden" name="artista_id" value="<%= artista.artista_id %>">
                                            <button type="submit" class="btn btn-danger btn-sm">Eliminar</button>
                                        </form>
                                    </td>
                                </tr>
                            <% }); %>
                        <% } else { %>
                            <tr>
                                <td colspan="7">No hay Artistas disponibles.</td>
                            </tr>
                        <% } %>
                    </tbody>
                </table>
            </div>
        </div>

    </div>
</body>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<%- include('partials/footer') %>